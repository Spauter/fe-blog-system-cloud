<!DOCTYPE html>
<html lang="en">
<head>
    <script src="../js/echarts.js"></script>
    <meta charset="UTF-8">
    <meta name="keywords" content="韬韬的个人博客后台">
    <meta name="description" content="韬韬的个人博客-可定制的个人博客系统后台">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="ie-stand">
    <title>韬韬的个人博客后台管理</title>
    <link rel="stylesheet" href="../css/aside.css">
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="../js/layui/css/layui.css">
    <link rel="stylesheet" href="../css/backstage.css">
    <link rel="stylesheet" href="../font/font-awesome-4.7.0/css/font-awesome.min.css">
    <style>
        .content_container {
            display: flex;
            justify-content: space-between;
        }
        .chart {
            width: 48%; /* 设置每个图表的宽度，留有一些间距 */
            box-sizing: border-box;
        }
    </style>
</head>
<body>
<!-- S 侧边导航 -->
<div class="aside">
    <div class="aside_menu ">
        <ul class="layui-nav layui-nav-tree">
            <li class="layui-nav-item layui-nav-itemed">
                <a href="javascript:;">用户管理</a>
                <dl class="layui-nav-child">
                    <dd><a href="userinfo.html">个人信息</a></dd>
                    <dd class="layui-this"><a href="account.html">账户管理</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item layui-nav-itemed">
                <a href="javascript:;">博客管理</a>
                <dl class="layui-nav-child">
                    <dd><a href="newblog.html">新建博客</a></dd>
                    <dd><a href="manageblog.html">管理博客</a></dd>
                    <dd><a href="manageTags.html">分类和标签</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item layui-nav-itemed">
                <a href="javascript:;">媒体管理</a>
                <dl class="layui-nav-child">
                    <dd><a href="media.html">媒体库</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item layui-nav-itemed">
                <a href="javascript:;">个性化管理</a>
                <dl class="layui-nav-child">
                    <dd><a href="manageindex.html">首页管理</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item layui-nav-itemed">
                <a href="javascript:;">审核管理</a>
                <dl class="layui-nav-child">
                    <dd><a href="audit.html">后台数据</a></dd>
                </dl>
            </li>
        </ul>
    </div>
</div>
<!-- E 侧边导航 -->

<!-- S 导航区域 -->
<div class="nav">
    <nav class="nav_content">
        <div class="nav_title">
            <h1>FE个人博客后台管理</h1>
        </div>
        <div class="nav_user">
            <div class="user_avatar">
                <img src="./avatar.jpg" alt="头像">
            </div>
            <div class="user_cancel">
                <a href="javascript:;"><i class="fa fa-sign-out"></i>注销</a>
            </div>
        </div>
    </nav>
</div>
<div class="content_container" type="">
    <div id="CPU" class="chart" style="width: 400px;height:300px;"></div>
    <div id="RAM" class="chart" style="width: 400px;height:300px;"></div>
    <div id="Disk" class="chart" style="width: 400px;height:300px;"></div>
</div>
<div class="content_container">
    <div id="Clicks" class="chart" style="width: 1400px;height:400px;"></div>
</div>
<script src="../js/jquery.min.js"></script>
<script src="../js/layui/layui.js"></script>
<script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('RAM'));
    // 指定图表的配置项和数据
    option = {
        color:["#A2505D","#BB9795"],
        series: [
            {
                type: 'pie',
                radius: ['30%', '50%'],
                data: [
                    {
                        value: 10,
                        name: '已使用'
                    },
                    {
                        value: 10,
                        name: '空闲'
                    },
                ]
            }
        ],
        title: {
            show: true,
            text: "RAM",
            subtext: "已使用" + 0+ "G,共" + 0+ "G"
        },
    }
    // 使用刚指定的配置项和数据显示图表。
    myChart.setOption(option);

    function updateData() {
        $.ajax({
            type: 'GET',
            url: '../fe-ornament/RAMUsage',
            dataType: 'json',
            success: function (res) {
                let freeMemory = res.freeMemory;
                let usageMemory = res.usagMemory;
                let totoalMemory = res.totoalMemory
                // 更新图表数据
                myChart.setOption({
                    series: [{
                        data: [
                            {
                                value: usageMemory,
                                name: '已使用',
                            },
                            {
                                value: freeMemory,
                                name: '空闲',
                            }
                        ]
                    }],
                    title: {
                        show: true,
                        text: "RAM",
                        subtext: "已使用" + usageMemory + "G,共" + totoalMemory + "G"
                    },
                });
            },
            error: function () {
            }
        });
    }

    setInterval(updateData, 7500);

</script>
<script type="text/javascript">
    var CPUChart = echarts.init(document.getElementById('CPU'));
    // 指定图表的配置项和数据
    CPUoption = {
        color:["#6D9E64","#EBE7E7"],
        series: [
            {
                type: 'pie',
                radius: ['30%', '50%'],
                data: [
                    {
                        value: 10,
                        name: '已使用'
                    },
                    {
                        value: 10,
                        name: '空闲'
                    },
                ]
            }
        ],
        title: {
            show: true,
            text: "CPU",
            subtext: "已使用" + 0+ "%"
        },
    }
    // 使用刚指定的配置项和数据显示图表。
    CPUChart.setOption(CPUoption);

    function updateCPUData() {
        $.ajax({
            type: 'GET',
            url: '../fe-ornament/CPUUsage',
            dataType: 'json',
            success: function (res) {
                let cpuUsage = res.cpuUsage;
                let cpuFree=res.cpuFree
                if (cpuUsage>100){
                    cpuUsage=100;
                    cpuFree=0;
                }
                // 更新图表数据
                CPUChart.setOption({
                    series: [{
                        data: [
                            {
                                value: cpuUsage,
                                name: '已使用',
                            },
                            {
                                value: cpuFree,
                                name: '空闲',
                            }
                        ]
                    }],
                    title: {
                        show: true,
                        text: "CPU",
                        subtext: "已使用" + cpuUsage + "%"
                    },
                });
            },
            error: function () {
            }
        });
    }

    setInterval(updateCPUData, 2500);
</script>
<script type="text/javascript">
    var DiskChart = echarts.init(document.getElementById('Disk'));
    updateDiskData();
    // 指定图表的配置项和数据
    Diskoption = {
        color:["#26A0DA","#E6E6E6"],
        series: [
            {
                type: 'pie',
                radius: ['30%', '50%'],
                data: [
                    {
                        value: 10,
                        name: '已使用'
                    },
                    {
                        value: 10,
                        name: '空闲'
                    },
                ]
            }
        ],
        title: {
            show: true,
            text: "磁盘",
            subtext: "已使用" + 0+ "G,共0G"
        },
    }
    // 使用刚指定的配置项和数据显示图表。
    DiskChart.setOption(Diskoption);

    function updateDiskData() {
        $.ajax({
            type: 'GET',
            url: '../fe-ornament/DiskUsage',
            dataType: 'json',
            success: function (res) {
                let freeSpace = res.freeSpace;
                let usage=res.usage
                let total=res.total
                // 更新图表数据
                DiskChart.setOption({
                    color:["#26A0DA","#E6E6E6"],
                    series: [{
                        data: [
                            {
                                value: usage,
                                name: '已使用',
                            },
                            {
                                value: freeSpace,
                                name: '空闲',
                            }
                        ]
                    }],
                    title: {
                        show: true,
                        text: "磁盘",
                        subtext: "已使用" + usage + "G,总共"+total+"G"
                    },
                });
            },
            error: function () {
            }
        });
    }

    setInterval(updateDiskData, 120000);
</script>
<script>
    updateClickData();

    var ClicksChart = echarts.init(document.getElementById('Clicks'));
    Clicksoption = {
        xAxis: {
            data: ['A', 'B', 'C', 'D', 'E'],
            axisLabel: {
                interval: 0
            }
        },
        yAxis: {},
        series: [
            {
                data: [10, 22, 28, 23, 19],
                type: 'line',
                label: {
                    show: true,
                    position: 'bottom',
                    textStyle: {
                        fontSize: 20
                    }
                }
            }
        ]
    };

    function updateClickData() {
        $.ajax({
            type: 'GET',
            url: '../fe-blog/hotBlogs',
            dataType: 'json',
            success: function (res) {
                let data=res.data;
                let length=res.count;
                var titles=[];
                var clicks=[];
                for(i=0;i<length;i++){
                    titles[i]=data[i].title;
                    clicks[i]=data[i].clicks;
                }
                // 更新图表数据
                ClicksChart.setOption({
                    xAxis: {
                        data: titles
                    },
                    yAxis: {},
                    series: [
                        {
                            data: clicks,
                            type: 'line',
                            label: {
                                show: true,
                                position: 'bottom',
                                textStyle: {
                                    fontSize: 20
                                }
                            }
                        }
                    ],
                    title: {
                        show: true,
                        text: "点击数最多的博客",
                    },
                });
            },
            error: function () {
                console.log("获取失败")
            }
        });
    }


    ClicksChart.setOption(Clicksoption);
</script>
</body>

</html>